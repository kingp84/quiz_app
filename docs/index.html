<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Forensics Quiz App</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root {
      --primary: #0b5cab;
      --card-bg: #fff;
      --page-bg: #f4f6f9;
      --muted: #666;
    }
    body { font-family: "Segoe UI", Arial, sans-serif; margin: 24px; max-width: 880px; background: var(--page-bg); color:#222; }
    .banner { display:flex; align-items:center; justify-content:space-between; background:#111; color:#fff; padding:14px 18px; border-radius:10px; margin-bottom:18px; }
    .banner h1 { margin:0; font-size:1.3rem; }
    .card { background:var(--card-bg); border-radius:10px; padding:16px; box-shadow:0 6px 18px rgba(0,0,0,0.06); margin-bottom:16px; border:1px solid #ddd; }
    label { font-weight:600; display:block; margin-top:10px; }
    input[type="text"] { width:100%; padding:10px; border-radius:8px; border:1px solid #bbb; margin-top:6px; }
    button { margin-top:14px; padding:10px 16px; background:var(--primary); color:#fff; border:none; border-radius:8px; cursor:pointer; font-weight:600; }
    button:hover { background:#08427a; }
    .muted { color:var(--muted); font-size:0.95rem; margin-top:8px; }
    #intro, #quizPage, #resultsPage { display:none; }
    #intro { display:block; }
    #quiz { margin-top:12px; }
    .progress { margin-top:10px; color:var(--muted); }
  </style>
</head>
<body>
  <div class="banner">
    <h1>Forensics Quiz App üïµÔ∏è</h1>
    <div style="font-weight:700; background:linear-gradient(90deg,#f9d71c,#f39c12); padding:6px 10px; border-radius:6px; color:#111;">CRIME SCENE</div>
  </div>

  <!-- Intro / instructions -->
  <div id="intro" class="card">
    <p>Welcome! This quiz will test your knowledge of forensic science concepts. Follow the instructions carefully.</p>
    <h2>--- Test Instructions ---</h2>
    <ol>
      <li>Read each multiple-choice question carefully.</li>
      <li>Select the best answer from the options provided.</li>
      <li>Answer short-answer questions in complete sentences.</li>
      <li>Bonus questions can earn extra points but never subtract points.</li>
      <li>Do your best and good luck!</li>
    </ol>

    <form id="studentForm" autocomplete="on" class="muted">
      <label for="name">Name</label>
      <input id="name" type="text" placeholder="First Last" required />
      <label for="hour">Class hour</label>
      <input id="hour" type="text" placeholder="e.g., 2nd hour" required />
      <button type="submit">Start Test</button>
      <div class="muted">Your name and hour will be saved with your responses for teacher review.</div>
    </form>
  </div>

  <!-- Quiz page (hidden until start) -->
  <div id="quizPage" class="card">
    <h2>Quiz in progress</h2>
    <div id="quiz"></div>
    <div id="progress" class="progress"></div>
  </div>

  <!-- Results page (hidden until finish) -->
  <div id="resultsPage" class="card">
    <h2>Quiz complete</h2>
    <div id="results"></div>
    <button id="downloadBtn">Download my responses (CSV)</button>
    <div class="muted">Save the CSV and send it to your teacher if requested.</div>
  </div>

  <!-- Load quiz logic -->
  <script src="quiz.js"></script>

  <!-- Wiring: form handler and button hooks (runs after quiz.js loads) -->
  <script>
    // Ensure student_responses exists even if quiz.js has an error
    window.student_responses = window.student_responses || { mc: [], short: [], bonus: [], student_info: {} };

    // Hook download button (downloadCSV defined in quiz.js)
    document.getElementById('downloadBtn').addEventListener('click', function () {
      if (typeof downloadCSV === 'function') {
        downloadCSV();
      } else {
        alert('Download not available: quiz script not loaded.');
      }
    });

    // Form submit starts the quiz (startQuiz defined in quiz.js)
    document.getElementById('studentForm').addEventListener('submit', function (e) {
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      const hour = document.getElementById('hour').value.trim();
      if (!name || !hour) return;
      window.student_responses.student_info = { name, hour };

      // Switch views
      document.getElementById('intro').style.display = 'none';
      document.getElementById('quizPage').style.display = 'block';

      // Call startQuiz (guarded)
      if (typeof startQuiz === 'function') {
        try {
          startQuiz();
        } catch (err) {
          console.error('Error starting quiz:', err);
          document.getElementById('quiz').innerHTML = '<p class="muted">An error occurred starting the quiz. Check console for details.</p>';
        }
      } else {
        document.getElementById('quiz').innerHTML = '<p class="muted">Quiz script not loaded or startQuiz not defined.</p>';
      }
    });
  </script>
</body>
</html>